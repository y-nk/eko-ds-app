(this["webpackJsonpeko-ds-app"]=this["webpackJsonpeko-ds-app"]||[]).push([[0],{52:function(e,t,n){e.exports=n(77)},57:function(e,t,n){},58:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),o=n(9),r=n.n(o),l=(n(57),n(3)),i=n(31),u=n(16),s=n(5),d=Object(a.createContext)(null),m={nodes:{},edges:[]},f=function(e){var t=e.children,n=Object(a.useState)(m.nodes),o=Object(s.a)(n,2),r=o[0],f=o[1],v=Object(a.useState)(m.edges),E=Object(s.a)(v,2),g=E[0],b=E[1],O=Object(a.useState)([]),p=Object(s.a)(O,2),j=p[0],y=p[1],h=function(e,t,n){l.link(m,e,t,n),b(Object(i.a)(m.edges))},x=function(e,t){l.unlink(m,e,t),b(Object(i.a)(m.edges))},k={nodes:r,add:function(e,t){var n=null!==e?e:Date.now().toString(16);l.add(m,n,Object(u.a)({id:n,name:n},t)),f(Object(u.a)({},m.nodes))},del:function(e){l.del(m,e),f(Object(u.a)({},m.nodes));var t=j.indexOf(e);-1!==t&&y(j.slice(0,t))},move:function(e,t,n){m.nodes[e]=Object(u.a)({},m.nodes[e],{x:t,y:n}),f(Object(u.a)({},m.nodes))},rename:function(e,t){m.nodes[e]=Object(u.a)({},m.nodes[e],{name:t}),f(Object(u.a)({},m.nodes))},edges:g,link:h,unlink:x,valuate:function(e,t,n){x(e,t),h(e,t,n)},steps:j,step:function(e){if(null!==e)if(j.length)try{l.edgeFor(m,j[j.length-1],e),y([].concat(Object(i.a)(j),[e]))}catch(t){console.warn("already exists")}else y([e]);else y([])}};return c.a.createElement(d.Provider,{value:k},t)},v=(n(58),n(26)),E=n(39),g=n.n(E),b=(n(66),function(e){var t=e.children;return c.a.createElement("h1",{className:"title"},t)});b.defaultProps={children:[]};var O=b,p=(n(67),n(101)),j=n(100),y=n(40),h=n.n(y),x=n(42),k=n.n(x),w=n(43),C=n.n(w),N={move:{icon:h.a,name:"Re-arrange the map"},edit:{icon:k.a,name:"Edit the map"},plan:{icon:C.a,name:"Plan a route"}},M=function(e){var t=e.mode,n=e.setMode,o=Object(a.useState)(!1),r=Object(s.a)(o,2),l=r[0],i=r[1],u=N[t].icon;return c.a.createElement(p.a,{className:"dial",ariaLabel:"speeddial",direction:"up",icon:c.a.createElement(u,{htmlColor:"#fff"}),open:l,onOpen:function(){return i(!0)},onClose:function(){return i(!1)}},Object.entries(N).map((function(e){var t=Object(s.a)(e,2),a=t[0],o=t[1];return c.a.createElement(j.a,{key:o.name,icon:c.a.createElement(o.icon,{htmlColor:"var(--".concat(a,")")}),tooltipTitle:o.name,onClick:function(){return n(a),void i(!1)}})})))},D=(n(70),n(47)),P=function(e){var t=e.children,n=Object(D.a)(e,["children"]);return(c.a.createElement("svg",Object.assign({overflow:"visible"},n),t))};P.defaultProps={children:[]};var S=P,L=(n(71),function(){return c.a.createElement("g",{className:"cross"},c.a.createElement("line",{x1:"0",y1:"-2",x2:"0",y2:"2"}),c.a.createElement("line",{x1:"-2",y1:"0",x2:"2",y2:"0"}))}),U=function(e){var t=e.children,n=e.onClick,a=e.onMouseUp;return c.a.createElement("svg",{className:"graph"},c.a.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",onClick:n,onMouseUp:a}),c.a.createElement(S,{x:"50%",y:"50%"},c.a.createElement(L,null),t))};U.defaultProps={children:[],onClick:null,onMouseUp:null};var F=U,A=n(8),B=n.n(A),I=(n(72),function(e){var t=e.className,n=e.x,a=e.y,o=e.children;return c.a.createElement(S,{className:t,x:n,y:a},c.a.createElement("foreignObject",null,o))});I.defaultProps={className:"",x:0,y:0,children:[]};var T=I,H=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=Object(a.useState)(!1),c=Object(s.a)(n,2),o=c[0],r=c[1];return Object(a.useEffect)((function(){var n=function(t){return e({x:t.clientX-.5*window.innerWidth,y:t.clientY-.5*window.innerHeight})},a=function(){t&&r(!1)};return o?(window.addEventListener("mousemove",n),window.addEventListener("mouseup",a)):(window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",a)),function(){window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",a)}}),[t,o,e]),{dragging:o,setDragging:r}},J=function(e){var t=e.id,n=e.x,o=e.y,r=e.name,l=Object(a.useContext)(d).move,i=H((function(e){return l(t,e.x,e.y)})),u=i.dragging,s=i.setDragging;return c.a.createElement(T,{className:B()("node move",{dragging:u}),x:n,y:o},c.a.createElement("div",{onMouseDown:function(){return s(!0)}},r))};J.defaultProps={x:0,y:0};var R=J,W=(n(73),n(45)),X=function(e){var t=e.className,n=e.from,o=e.to,r=e.children,l=Object(a.useContext)(d).steps,i=Object(W.indexesOf)([n.id,o.id],l).length>0,u=.5*(n.x+o.x),s=.5*(n.y+o.y),m=Math.atan2(o.y-n.y,o.x-n.x)*(180/Math.PI);return c.a.createElement("g",{className:B()(t,{selected:i}),transform:"translate(".concat(u," ").concat(s,")")},c.a.createElement("line",{x1:n.x-u,x2:o.x-u,y1:n.y-s,y2:o.y-s}),c.a.createElement("g",{transform:"translate(".concat(o.x-u," ").concat(o.y-s,")")},c.a.createElement("polygon",{points:"-30,-5 -20,0 -30,5",transform:"rotate(".concat(m,")")})),c.a.createElement("foreignObject",null,r))};X.defaultProps={className:"",children:[]};var Y=X,K=function(e){var t=e.from,n=e.to,o=e.cost,r=Object(a.useContext)(d).move,l=.5*(n.x-t.x),i=.5*(n.y-t.y),u=H((function(e){var a=e.x,c=e.y;r(t.id,a-l,c-i),r(n.id,a+l,c+i)})),s=u.dragging,m=u.setDragging;return c.a.createElement(Y,{className:B()("edge move",{dragging:s}),from:t,to:n},o?c.a.createElement("div",{onMouseDown:function(){return m(!0)}},o):null)};K.defaultProps={cost:0};var q=K,z=function(){var e=Object(a.useContext)(d),t=e.nodes,n=e.edges;return c.a.createElement(F,null,n.map((function(e){return c.a.createElement(q,{key:"".concat(e.from).concat(e.to),from:t[e.from],to:t[e.to],cost:e.cost})})),Object.values(t).map((function(e){return c.a.createElement(R,{key:e.id,id:e.id,x:e.x,y:e.y,name:e.name})})))},G=(n(74),function(e){var t=e.value,n=e.onChange,o=Object(a.useState)(t),r=Object(s.a)(o,2),l=r[0],i=r[1],u=Object(a.useState)(!t.length),d=Object(s.a)(u,2),m=d[0],f=d[1],v=Object(a.createRef)(),E=Object(a.useCallback)((function(){n(l),f(!1)}),[l,n]);return Object(a.useEffect)((function(){return m&&v.current.focus(),m?window.addEventListener("click",E):window.removeEventListener("click",E),function(){return window.removeEventListener("click",E)}}),[E,m,v]),c.a.createElement("input",{ref:v,className:"input",type:"text",readOnly:!m,onClick:function(){return f(!m)},value:l,onChange:function(e){return i(e.target.value)},onKeyUp:function(e){"Enter"===e.key?E():"Escape"===e.key&&function(e){e&&e.stopImmediatePropagation(),i(t),f(!1)}()}})}),Q=(n(75),n(46)),V=n.n(Q),Z=function(e){var t=e.onClick;return c.a.createElement("span",{className:"delete",onClick:function(e){e.stopPropagation(),t()}},c.a.createElement(V.a,{htmlColor:"currentColor"}))},$=function(e){var t=e.id,n=e.name,o=e.x,r=e.y,l=e.active,i=e.onMouseDown,u=e.onMouseUp,m=Object(a.useContext)(d),f=m.del,v=m.rename,E=Object(a.useState)({x:0,y:0}),g=Object(s.a)(E,2),b=g[0],O=b.x,p=b.y,j=g[1],y=H((function(e){var t=Math.atan2(e.y-r,e.x-o);j({x:20*Math.cos(t),y:20*Math.sin(t)})}),!1).setDragging;return c.a.createElement(T,{className:B()("node edit",{active:l}),x:o,y:r},c.a.createElement("div",{onMouseEnter:function(){return y(!0)},onMouseLeave:function(){l||y(!1)}},c.a.createElement(G,{value:n,onChange:function(e){return v(t,e)}}),c.a.createElement("span",{className:"hook",style:{transform:"translate(".concat(O,"px, ").concat(p,"px")},onMouseDown:function(e){return i(e,t)},onMouseUp:function(e){return u(e,t)}}),c.a.createElement(Z,{onClick:function(){return f(t)}})))};$.defaultProps={x:0,y:0,active:!1};var _=$,ee=function(e){var t=e.from,n=e.to,o=e.cost,r=Object(a.useContext)(d),l=r.unlink,i=r.valuate,u=!isNaN(o);return c.a.createElement(Y,{className:"edge edit",from:t,to:n},u?c.a.createElement("div",null,c.a.createElement(G,{pattern:"\\d+",value:o.toString(),onChange:function(e){return i(t.id,n.id,parseFloat(e))}}),c.a.createElement(Z,{onClick:function(){return l(t.id,n.id)}})):null)};ee.defaultProps={cost:0};var te=ee,ne=function(){var e=Object(a.useContext)(d),t=e.nodes,n=e.edges,o=e.add,r=e.link,l=Object(a.useState)(null),i=Object(s.a)(l,2),u=i[0],m=i[1],f=Object(a.useState)({x:0,y:0}),v=Object(s.a)(f,2),E=v[0],g=v[1],b=H(g,!1).setDragging,O=function(e,t){m(t),b(!0)},p=function(e,t){if(b(!1),m(null),u!==t)try{r(u,t,0)}catch(n){console.warn("broken edge")}};return c.a.createElement(F,{onClick:function(e){o(null,{x:e.clientX-.5*window.innerWidth,y:e.clientY-.5*window.innerHeight,name:""})},onMouseUp:function(){b(!1),m(null)}},n.map((function(e){return c.a.createElement(te,{key:"".concat(e.from).concat(e.to),from:t[e.from],to:t[e.to],cost:e.cost})})),u?c.a.createElement(te,{key:"draft",from:t[u],to:E}):null,Object.values(t).map((function(e){return c.a.createElement(_,{key:e.id,id:e.id,x:e.x,y:e.y,name:e.name,active:e.id===u,onMouseDown:O,onMouseUp:p})})))},ae=function(e){var t=e.x,n=e.y,a=e.name,o=e.active,r=e.onClick;return c.a.createElement(T,{className:B()("node plan",{active:o}),x:t,y:n},c.a.createElement("div",{onClick:r},a))};ae.defaultProps={x:0,y:0,active:!1};var ce=ae,oe=function(e){var t=e.from,n=e.to,a=e.cost,o=e.highlight;return c.a.createElement(Y,{className:B()("edge plan",{highlight:o}),from:t,to:n},c.a.createElement("div",null,a))};oe.defaultProps={cost:0,highlight:!1};var re=oe,le=function(){var e=Object(a.useContext)(d),t=e.nodes,n=e.edges,o=e.steps,r=e.step,i=Object(a.useState)(!1),u=Object(s.a)(i,2),m=u[0],f=u[1],v=o.length?Object(l.edgesOf)({nodes:t,edges:n},o[o.length-1],"from"):[];return c.a.createElement(F,null,n.map((function(e){return c.a.createElement(re,{key:"".concat(e.from).concat(e.to),from:t[e.from],to:t[e.to],cost:e.cost,highlight:m&&v.includes(e)})})),Object.values(t).map((function(e){return c.a.createElement(ce,{key:e.id,id:e.id,x:e.x,y:e.y,name:e.name,active:o.includes(e.id),onClick:function(){return function(e){m?v.find((function(t){return t.to===e}))?r(e):e!==o[0]&&e!==o[o.length-1]||(1===o.length&&r(null),f(!1)):o.length?r(null):(f(!0),r(e))}(e.id)}})})))},ie=(n(76),function(){var e=Object(a.useContext)(d),t=e.nodes,n=e.edges,o=e.steps,r=Object(l.routeFor)({nodes:t,edges:n},o),i=Object(l.costOf)(r);return c.a.createElement("aside",{className:B()("report",{visible:i>0})},c.a.createElement("dl",null,c.a.createElement("dt",null,"Edge"),c.a.createElement("dd",null,"Cost"),r.map((function(e){return[c.a.createElement("dt",{key:"dt".concat(e.from).concat(e.to)},t[e.from].name," ","\u2192"," ",t[e.to].name),c.a.createElement("dd",{key:"dd".concat(e.from).concat(e.to)},e.cost)]})),c.a.createElement("dt",null,"Total"),c.a.createElement("dd",null,i)))}),ue=["move","edit","plan"],se=g()(),de=Object(v.d)(se),me=function(){var e=window.location.hash.slice(1),t=Object(a.useState)(ue.includes(e)?e:"move"),n=Object(s.a)(t,2),o=n[0],r=n[1];return c.a.createElement(v.a,{history:de},c.a.createElement("div",{className:"app ".concat(o)},c.a.createElement(O,null,"Eko Delivery Service"),c.a.createElement(M,{mode:o,setMode:function(e){r(e),de.navigate("/".concat(e))}}),c.a.createElement(ie,null),c.a.createElement(v.c,{className:"router"},c.a.createElement(z,{path:"/move"}),c.a.createElement(ne,{path:"/edit"}),c.a.createElement(le,{path:"/plan"}),c.a.createElement(v.b,{from:"/",to:"/".concat("move"),default:!0,noThrow:!0}))))};Object(l.add)(m,"A",{name:"A",x:-100,y:0}),Object(l.add)(m,"B",{name:"B",x:-100,y:-200}),Object(l.add)(m,"C",{name:"C",x:-100,y:200}),Object(l.add)(m,"D",{name:"D",x:100,y:0}),Object(l.add)(m,"E",{name:"E",x:100,y:-200}),Object(l.add)(m,"F",{name:"F",x:100,y:200}),Object(l.link)(m,"A","B",1),Object(l.link)(m,"A","C",4),Object(l.link)(m,"A","D",10),Object(l.link)(m,"B","E",3),Object(l.link)(m,"C","D",4),Object(l.link)(m,"C","F",2),Object(l.link)(m,"D","E",1),Object(l.link)(m,"E","A",2),Object(l.link)(m,"E","B",3),Object(l.link)(m,"F","D",1);r.a.render(c.a.createElement((function(){return c.a.createElement(f,null,c.a.createElement(me,null))}),null),document.getElementById("root"))}},[[52,1,2]]]);
//# sourceMappingURL=main.f7c2ad85.chunk.js.map